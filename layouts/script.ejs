<!--SCRIPTS END-->
  <% if (post.comments) { %>
      <% if (theme.disqus_shortname) { %>
 -        <script type="text/javascript">
 -            var disqus_shortname = '<%= theme.disqus_shortname %>';
 +        <script>
 +             var disqus_config = function () {
 +                 this.page.url = '<%= post.permalink %>';
 +                 this.page.identifier = '<%= post.path %>';
 +             };
              (function() {
 -                var dsq = document.createElement('script');
 -                dsq.type = 'text/javascript';
 -                dsq.async = true;
 -                dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
 -                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
 +                var d = document, s = d.createElement('script');
 +                var disqus_shortname = '<%= theme.disqus_shortname %>';
 +                s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
 +
 +                s.setAttribute('data-timestamp', +new Date());
 +                (d.head || d.body).appendChild(s);
              })();
          </script>
      <% } else if (theme.duoshuo_shortname) { %>